<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RichBrat$ Customs</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <style>
        :root {
            --gold: #d4af37;
            --black: #050505;
            --glass: rgba(15, 15, 15, 0.95);
            --hud-blue: #00f3ff;
            --font-main: 'Rajdhani', sans-serif;
            --font-tech: 'Orbitron', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: var(--black); color: #fff; font-family: var(--font-main); overflow-x: hidden; min-height: 100vh; }

        /* CURSOR & BG */
        #cursor {
            position: fixed; width: 20px; height: 20px;
            border: 2px solid var(--gold); border-radius: 50%;
            transform: translate(-50%, -50%); pointer-events: none; z-index: 9999;
            transition: background 0.2s; mix-blend-mode: difference;
        }
        body:hover #cursor { opacity: 1; }
        
        #matrix-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.2; }

        /* NAV */
        nav {
            position: fixed; top: 0; width: 100%; padding: 15px 30px;
            display: flex; justify-content: space-between; align-items: center; z-index: 100;
            background: rgba(0,0,0,0.9); border-bottom: 1px solid #333;
        }
        .logo-box img { height: 50px; cursor: pointer; }
        .cyber-btn {
            background: transparent; border: 1px solid var(--gold); color: var(--gold);
            padding: 8px 20px; font-family: var(--font-tech); cursor: pointer;
            transition: 0.3s;
        }
        .cyber-btn:hover { background: var(--gold); color: #000; }

        /* SECTIONS */
        .container { padding-top: 100px; display: flex; justify-content: center; min-height: 100vh; }
        section { display: none; width: 100%; max-width: 1200px; animation: fadeIn 0.5s; }
        section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* HOME GRID */
        .grid-menu { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px; padding: 20px; }
        .holo-card {
            background: var(--glass); border: 1px solid #333; padding: 40px; text-align: center;
            cursor: pointer; transition: 0.3s;
        }
        .holo-card:hover { border-color: var(--gold); transform: translateY(-10px); box-shadow: 0 0 20px rgba(212,175,55,0.2); }
        .holo-card h2 { color: var(--gold); font-family: var(--font-tech); font-size: 1.5rem; margin-bottom: 10px; }

        /* STORE GRID */
        .store-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; margin-top: 20px; }
        .store-card { background: rgba(255,255,255,0.05); border: 1px solid #333; padding: 15px; text-align: center; }
        .prod-img { width: 100%; height: 150px; background-size: cover; background-position: center; background-color: #222; margin-bottom: 10px; }
        .price { color: var(--gold); font-size: 1.2rem; font-weight: bold; margin: 10px 0; }

        /* FORMS */
        .glass-panel { background: var(--glass); border: 1px solid var(--gold); padding: 40px; max-width: 600px; margin: 0 auto; text-align: center; }
        input, select, textarea {
            width: 100%; background: #080808; border: 1px solid #333; color: #fff;
            padding: 12px; margin-bottom: 15px; font-family: var(--font-main); font-size: 1rem;
        }
        input:focus { border-color: var(--gold); outline: none; }
        .full-width { width: 100%; padding: 15px; font-weight: bold; font-size: 1.1rem; }
    </style>
</head>
<body>

    <div id="cursor"></div>
    <canvas id="matrix-canvas"></canvas>

    <nav>
        <div class="logo-box" onclick="app.goHome()">
            <img src="logo.png" alt="RICHBRAT$" onerror="this.style.display='none'; document.getElementById('txt-logo').style.display='block'">
            <span id="txt-logo" style="display:none; color:#d4af37; font-weight:bold; font-size:1.5rem;">RICHBRAT$</span>
        </div>
        <button class="cyber-btn" onclick="app.goHome()">HOME</button>
    </nav>

    <main class="container">
        
        <section id="home" class="active">
            <div class="grid-menu">
                <div class="holo-card" onclick="app.loadStore()">
                    <h2>STORE</h2>
                    <p>> LIVE INVENTORY</p>
                </div>
                <div class="holo-card" onclick="app.nav('booking')">
                    <h2>BOOKING</h2>
                    <p>> RESERVE SLOT</p>
                </div>
                <div class="holo-card" onclick="app.nav('consult')">
                    <h2>CONSULT</h2>
                    <p>> EXPERT CHAT</p>
                </div>
            </div>
        </section>

        <section id="store">
            <div class="glass-panel" style="max-width:1000px;">
                <h2 style="color:var(--gold)">INVENTORY</h2>
                <div id="loading-store">LOADING DATA...</div>
                <div class="store-grid" id="product-list"></div>
                <button class="cyber-btn" onclick="app.goHome()" style="margin-top:20px">BACK</button>
            </div>
        </section>

        <section id="booking">
            <div class="glass-panel">
                <h2 style="color:var(--gold)">RESERVATION</h2>
                <form onsubmit="app.bookSlot(event)" id="bookingForm">
                    <input type="date" id="dateInput" required onchange="app.checkSlots()">
                    <select id="timeInput" disabled><option>Select Date First</option></select>
                    <input type="text" id="b_name" placeholder="Name" required>
                    <input type="tel" id="b_phone" placeholder="Phone" required>
                    <input type="text" id="b_car" placeholder="Car Model" required>
                    <button class="cyber-btn full-width" id="bookBtn">CONFIRM SLOT</button>
                </form>
                <div id="booking-status" style="margin-top:10px;"></div>
                <button class="cyber-btn" onclick="app.goHome()" style="margin-top:20px">BACK</button>
            </div>
        </section>

        <section id="consult">
            <div class="glass-panel">
                <h2 style="color:var(--gold)">PROJECT BRIEF</h2>
                <form id="consultForm">
                    <input type="text" id="u_name" placeholder="Name" required>
                    <input type="email" id="u_email" placeholder="Email" required>
                    <input type="text" id="u_car" placeholder="Car Model" required>
                    <textarea id="u_message" rows="4" placeholder="Modifications..."></textarea>
                    <button type="button" class="cyber-btn full-width" onclick="app.sendMail()">SEND PROJECT</button>
                </form>
                <div id="status-log" style="margin-top:10px;"></div>
                <button class="cyber-btn" onclick="app.goHome()" style="margin-top:20px">BACK</button>
            </div>
        </section>

    </main>

    <script>
        // --- PASTE YOUR GOOGLE SCRIPT URL BELOW ---
        const SCRIPT_URL = "PASTE_YOUR_GOOGLE_SCRIPT_URL_HERE"; 
        
        // --- EMAILJS CONFIG ---
        const EMAIL_KEY = "9-7GR7Lab7wUNI5sH";
        const SERVICE_ID = "service_ilkre51";
        const TEMPLATE_ID = "template_hu62u55";

        class App {
            constructor() {
                this.initCanvas();
                this.initCursor();
                emailjs.init(EMAIL_KEY);
            }

            nav(id) {
                document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
                document.getElementById(id).classList.add('active');
            }
            goHome() { this.nav('home'); }

            // STORE LOGIC
            async loadStore() {
                this.nav('store');
                const list = document.getElementById('product-list');
                const loader = document.getElementById('loading-store');
                list.innerHTML = "";
                loader.style.display = 'block';

                try {
                    const res = await fetch(`${SCRIPT_URL}?action=getInventory`);
                    const data = await res.json();
                    loader.style.display = 'none';

                    if(data.length === 0) { list.innerHTML = "<p>OUT OF STOCK</p>"; return; }

                    data.forEach(p => {
                        list.innerHTML += `
                        <div class="store-card">
                            <div class="prod-img" style="background-image:url('${p.image}')"></div>
                            <h3>${p.name}</h3>
                            <div class="price">$${p.price}</div>
                            <button class="cyber-btn" onclick="window.open('https://wa.me/919999999999?text=Buy ${p.name}')">BUY</button>
                        </div>`;
                    });
                } catch(e) { loader.innerText = "DATA ERROR - CHECK SCRIPT URL"; }
            }

            // BOOKING LOGIC
            async checkSlots() {
                const date = document.getElementById('dateInput').value;
                const sel = document.getElementById('timeInput');
                const btn = document.getElementById('bookBtn');
                
                sel.innerHTML = "<option>SCANNING...</option>";
                sel.disabled = true; btn.disabled = true;

                try {
                    const res = await fetch(`${SCRIPT_URL}?action=checkSlots&date=${date}`);
                    const taken = await res.json();
                    const hours = ["10:00","11:00","12:00","13:00","14:00","15:00","16:00"];
                    
                    const avail = hours.filter(h => !taken.includes(h));
                    sel.innerHTML = "";
                    
                    if(avail.length === 0) { sel.innerHTML = "<option>FULL</option>"; }
                    else {
                        avail.forEach(h => sel.innerHTML += `<option value="${h}">${h}</option>`);
                        sel.disabled = false; btn.disabled = false;
                    }
                } catch(e) { sel.innerHTML = "<option>ERROR</option>"; }
            }

            async bookSlot(e) {
                e.preventDefault();
                const btn = document.getElementById('bookBtn');
                const stat = document.getElementById('booking-status');
                btn.innerText = "BOOKING...";
                
                const fd = new FormData();
                fd.append('date', document.getElementById('dateInput').value);
                fd.append('time', document.getElementById('timeInput').value);
                fd.append('name', document.getElementById('b_name').value);
                fd.append('phone', document.getElementById('b_phone').value);
                fd.append('car', document.getElementById('b_car').value);

                try {
                    await fetch(SCRIPT_URL, {method:'POST', body:fd});
                    stat.innerText = "CONFIRMED!";
                    stat.style.color = "#d4af37";
                    document.getElementById('bookingForm').reset();
                    setTimeout(() => { this.goHome(); stat.innerText=""; btn.innerText="CONFIRM"; }, 2000);
                } catch(e) { stat.innerText = "FAILED"; }
            }

            // EMAIL LOGIC
            sendMail() {
                const btn = document.querySelector('#consultForm button');
                const stat = document.getElementById('status-log');
                btn.innerText = "SENDING...";
                
                const params = {
                    from_name: document.getElementById('u_name').value,
                    reply_to: document.getElementById('u_email').value,
                    car_model: document.getElementById('u_car').value,
                    message: document.getElementById('u_message').value
                };

                emailjs.send(SERVICE_ID, TEMPLATE_ID, params)
                .then(() => { stat.innerText = "SENT!"; stat.style.color="#d4af37"; btn.innerText="SEND PROJECT"; })
                .catch(() => { stat.innerText = "ERROR"; stat.style.color="red"; });
            }

            // VISUALS
            initCursor() {
                const c = document.getElementById('cursor');
                document.addEventListener('mousemove', e => { c.style.left=e.clientX+'px'; c.style.top=e.clientY+'px'; });
            }
            initCanvas() {
                const cvs = document.getElementById('matrix-canvas');
                const ctx = cvs.getContext('2d');
                cvs.width=window.innerWidth; cvs.height=window.innerHeight;
                const drops=[]; for(let i=0;i<100;i++) drops.push({x:Math.random()*cvs.width,y:Math.random()*cvs.height,s:Math.random()*2+1});
                function ani(){
                    ctx.clearRect(0,0,cvs.width,cvs.height); ctx.fillStyle='#d4af37';
                    drops.forEach(d=>{ d.y+=d.s; if(d.y>cvs.height)d.y=0; ctx.fillRect(d.x,d.y,2,2); });
                    requestAnimationFrame(ani);
                }
                ani();
            }
        }

        const app = new App();
    </script>
</body>
</html>
