<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RichBrat$ Customs | Bespoke Automotive Art</title>
    
    <link href="https://api.fontshare.com/v2/css?f[]=satoshi@900,700,500&f[]=clash-display@600,700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, updateProfile } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, updateDoc, arrayUnion } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // --- ðŸ”´ PASTE YOUR FIREBASE CONFIG HERE ðŸ”´ ---
        const firebaseConfig = {
            apiKey: "AIzaSyDoU-ixQiMmjEofIAK_sQe729PZ86jseDY",
            authDomain: "richbart-customs.firebaseapp.com",
            projectId: "richbart-customs",
            storageBucket: "richbart-customs.firebasestorage.app",
            messagingSenderId: "717900685166",
            appId: "1:717900685166:web:095f2354c75917907c6b7f"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        window.auth = auth;
        window.db = db;
        window.firebase = { createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, doc, setDoc, getDoc, updateProfile };
    </script>

    <style>
        /* --- 1. LUXURY AESTHETICS --- */
        :root {
            --gold: #D4AF37;
            --gold-gradient: linear-gradient(135deg, #BF953F, #FCF6BA, #B38728, #FBF5B7, #AA771C);
            --black: #0a0a0a;
            --dark-grey: #121212;
            --text-main: 'Satoshi', sans-serif;
            --text-display: 'Clash Display', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background-color: var(--black); 
            color: #fff; 
            font-family: var(--text-main); 
            overflow-x: hidden;
        }

        /* --- UI COMPONENTS --- */
        .gold-text {
            background: var(--gold-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }

        .btn-luxury {
            background: transparent;
            border: 1px solid var(--gold);
            color: var(--gold);
            padding: 15px 40px;
            font-family: var(--text-display);
            text-transform: uppercase;
            letter-spacing: 2px;
            cursor: pointer;
            transition: 0.5s;
            position: relative;
            overflow: hidden;
        }
        
        .btn-luxury:hover {
            background: var(--gold);
            color: #000;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.4);
        }

        /* --- NAV --- */
        nav {
            position: fixed; top: 0; width: 100%; padding: 30px 50px;
            display: flex; justify-content: space-between; align-items: center;
            z-index: 1000; mix-blend-mode: difference;
        }
        .logo { font-family: var(--text-display); font-size: 1.5rem; font-weight: 700; letter-spacing: 1px; }
        
        .user-panel { display: flex; gap: 20px; align-items: center; }
        .auth-btn { cursor: pointer; font-weight: 600; font-size: 0.9rem; }

        /* --- HERO SECTION --- */
        .hero {
            height: 100vh; width: 100%;
            display: flex; align-items: center; justify-content: center;
            position: relative;
        }
        .hero-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, rgba(0,0,0,0.3) 0%, rgba(0,0,0,1) 100%), 
                        url('https://images.unsplash.com/photo-1618843479313-40f8afb4b4d8?q=80&w=2070&auto=format&fit=crop');
            background-size: cover; background-position: center;
            z-index: -1; filter: grayscale(100%) contrast(1.2);
        }
        .hero-content { text-align: center; z-index: 2; opacity: 0; transform: translateY(50px); }
        .hero h1 { font-family: var(--text-display); font-size: 5rem; line-height: 1; margin-bottom: 20px; text-transform: uppercase; }
        .hero p { font-size: 1.2rem; letter-spacing: 3px; margin-bottom: 40px; color: #ccc; }

        /* --- ACCOUNT MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 2000;
            display: none; justify-content: center; align-items: center;
            backdrop-filter: blur(10px);
        }
        .modal-box {
            width: 400px; background: var(--dark-grey); border: 1px solid #333;
            padding: 40px; text-align: center; position: relative;
        }
        .close-modal { position: absolute; top: 20px; right: 20px; cursor: pointer; color: #666; }
        
        .form-input {
            width: 100%; background: transparent; border: none; border-bottom: 1px solid #333;
            padding: 15px 0; color: #fff; font-family: var(--text-main); font-size: 1rem; margin-bottom: 20px;
        }
        .form-input:focus { outline: none; border-bottom-color: var(--gold); }

        /* --- DASHBOARD (LOGGED IN) --- */
        .dashboard {
            min-height: 100vh; padding: 150px 50px; display: none;
        }
        .grid-layout {
            display: grid; grid-template-columns: 1fr 2fr; gap: 50px;
        }
        .profile-card {
            background: var(--dark-grey); padding: 40px; border: 1px solid #222;
        }
        .data-label { color: #666; font-size: 0.8rem; margin-bottom: 5px; display: block; }
        .data-val { font-size: 1.2rem; margin-bottom: 20px; display: block; font-family: var(--text-display); }

    </style>
</head>
<body>

    <nav>
        <div class="logo">RICHBRAT<span class="gold-text">$</span></div>
        <div class="user-panel" id="nav-actions">
            <div class="auth-btn" onclick="openModal('login')">LOGIN</div>
            <div class="btn-luxury" style="padding: 10px 25px; font-size: 0.8rem;" onclick="openModal('register')">BECOME A MEMBER</div>
        </div>
        <div class="user-panel" id="user-actions" style="display:none;">
            <div class="auth-btn" id="username-display">USER</div>
            <div class="auth-btn" onclick="app.logout()">LOGOUT</div>
        </div>
    </nav>

    <div class="modal-overlay" id="auth-modal">
        <div class="modal-box">
            <div class="close-modal" onclick="closeModal()">âœ•</div>
            <h2 id="modal-title" style="margin-bottom: 30px; font-family: var(--text-display);">ACCESS TERMINAL</h2>
            
            <form id="auth-form" onsubmit="app.handleAuth(event)">
                <input type="text" id="reg-name" class="form-input" placeholder="FULL NAME (Register Only)" style="display:none;">
                <input type="email" id="email" class="form-input" placeholder="EMAIL ADDRESS" required>
                <input type="password" id="password" class="form-input" placeholder="PASSWORD" required>
                
                <div id="extra-fields" style="display:none;">
                    <input type="text" id="reg-phone" class="form-input" placeholder="PHONE NUMBER">
                    <input type="text" id="reg-car" class="form-input" placeholder="CURRENT VEHICLE">
                    <input type="text" id="reg-insta" class="form-input" placeholder="INSTAGRAM HANDLE">
                </div>

                <button type="submit" class="btn-luxury" style="width:100%; margin-top:20px;" id="submit-btn">ENTER</button>
            </form>
            <p style="margin-top: 20px; font-size: 0.8rem; color:#666; cursor:pointer;" id="switch-text" onclick="switchMode()">New here? Create Account</p>
        </div>
    </div>

    <div id="view-landing">
        <section class="hero">
            <div class="hero-bg"></div>
            <div class="hero-content">
                <p>BESPOKE AUTOMOTIVE TAILORING</p>
                <h1>EXCELLENCE <span class="gold-text">REDEFINED</span></h1>
                <button class="btn-luxury" onclick="openModal('register')">JOIN THE CLUB</button>
            </div>
        </section>
    </div>

    <div id="view-dashboard" class="dashboard">
        <h1 style="font-family: var(--text-display); font-size: 3rem; margin-bottom: 50px;">
            WELCOME BACK, <span id="dash-name" class="gold-text">DRIVER</span>
        </h1>
        
        <div class="grid-layout">
            <div class="profile-card">
                <h3 style="margin-bottom:30px; border-bottom:1px solid #333; padding-bottom:10px;">DRIVER PROFILE</h3>
                
                <span class="data-label">VEHICLE ID</span>
                <span class="data-val" id="dash-car">--</span>
                
                <span class="data-label">CONTACT</span>
                <span class="data-val" id="dash-phone">--</span>

                <span class="data-label">MEMBER SINCE</span>
                <span class="data-val" id="dash-joined">2026</span>
                
                <button class="btn-luxury" style="width:100%; margin-top:20px; font-size:0.8rem;">EDIT PROFILE</button>
            </div>

            <div class="profile-card">
                <h3 style="margin-bottom:30px; border-bottom:1px solid #333; padding-bottom:10px;">ORDER HISTORY</h3>
                <div id="order-list" style="color:#666;">
                    > No recent orders found in database.
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- ANIMATIONS ---
        gsap.to(".hero-content", { duration: 1.5, y: 0, opacity: 1, ease: "power4.out", delay: 0.5 });

        // --- APP LOGIC ---
        let authMode = 'login'; // or 'register'

        const ui = {
            landing: document.getElementById('view-landing'),
            dash: document.getElementById('view-dashboard'),
            navLogin: document.getElementById('nav-actions'),
            navUser: document.getElementById('user-actions'),
            modal: document.getElementById('auth-modal')
        };

        // --- GLOBAL FUNCTIONS ---
        window.openModal = (mode) => {
            authMode = mode;
            ui.modal.style.display = 'flex';
            updateModalUI();
        }
        
        window.closeModal = () => ui.modal.style.display = 'none';

        window.switchMode = () => {
            authMode = authMode === 'login' ? 'register' : 'login';
            updateModalUI();
        }

        function updateModalUI() {
            const title = document.getElementById('modal-title');
            const btn = document.getElementById('submit-btn');
            const extras = document.getElementById('extra-fields');
            const nameField = document.getElementById('reg-name');
            const switchTxt = document.getElementById('switch-text');

            if(authMode === 'register') {
                title.innerText = "MEMBER REGISTRATION";
                btn.innerText = "CREATE ACCOUNT";
                extras.style.display = 'block';
                nameField.style.display = 'block';
                switchTxt.innerText = "Already a member? Login";
            } else {
                title.innerText = "ACCESS TERMINAL";
                btn.innerText = "ENTER";
                extras.style.display = 'none';
                nameField.style.display = 'none';
                switchTxt.innerText = "New here? Create Account";
            }
        }

        // --- AUTH CLASS ---
        class App {
            constructor() {
                // Listen for Login State Changes
                setTimeout(() => {
                   window.auth.onAuthStateChanged(user => {
                       if (user) {
                           this.loadUserProfile(user.uid);
                           ui.landing.style.display = 'none';
                           ui.dash.style.display = 'block';
                           ui.navLogin.style.display = 'none';
                           ui.navUser.style.display = 'flex';
                       } else {
                           ui.landing.style.display = 'block';
                           ui.dash.style.display = 'none';
                           ui.navLogin.style.display = 'flex';
                           ui.navUser.style.display = 'none';
                       }
                   });
                }, 1000); // Wait for Firebase to load
            }

            async handleAuth(e) {
                e.preventDefault();
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                try {
                    if (authMode === 'register') {
                        // 1. Create User
                        const cred = await window.firebase.createUserWithEmailAndPassword(window.auth, email, password);
                        const user = cred.user;
                        
                        // 2. Save Extra Details to Firestore Database
                        await window.firebase.setDoc(window.firebase.doc(window.db, "users", user.uid), {
                            name: document.getElementById('reg-name').value,
                            phone: document.getElementById('reg-phone').value,
                            car: document.getElementById('reg-car').value,
                            insta: document.getElementById('reg-insta').value,
                            joined: new Date().toISOString(),
                            email: email
                        });

                        // 3. Update Display Name
                        await window.firebase.updateProfile(user, { displayName: document.getElementById('reg-name').value });
                        
                    } else {
                        // Login
                        await window.firebase.signInWithEmailAndPassword(window.auth, email, password);
                    }
                    closeModal();
                } catch (error) {
                    alert("ACCESS DENIED: " + error.message);
                }
            }

            async loadUserProfile(uid) {
                const docSnap = await window.firebase.getDoc(window.firebase.doc(window.db, "users", uid));
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    document.getElementById('dash-name').innerText = data.name.toUpperCase();
                    document.getElementById('username-display').innerText = data.name.split(' ')[0].toUpperCase();
                    document.getElementById('dash-car').innerText = data.car || "NOT SET";
                    document.getElementById('dash-phone').innerText = data.phone || "NOT SET";
                }
            }

            logout() {
                window.firebase.signOut(window.auth);
            }
        }

        const app = new App();
    </script>
</body>
</html>
